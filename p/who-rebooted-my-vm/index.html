<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Investigating from a linux perspective, if the cloud provider is to be blamed for a virtual machine reboot."><title>Who rebooted my VM? A cloud mystery</title>
<link rel=canonical href=https://www.niederwanger.dev/p/who-rebooted-my-vm/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Who rebooted my VM? A cloud mystery"><meta property='og:description' content="Investigating from a linux perspective, if the cloud provider is to be blamed for a virtual machine reboot."><meta property='og:url' content='https://www.niederwanger.dev/p/who-rebooted-my-vm/'><meta property='og:site_name' content='Kevin Niederwanger'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='kubernetes'><meta property='article:tag' content='openshift'><meta property='article:tag' content='linux'><meta property='article:tag' content='cloud'><meta property='article:published_time' content='2025-04-04T00:00:00+00:00'><meta property='article:modified_time' content='2025-04-04T00:00:00+00:00'><meta property='og:image' content='https://www.niederwanger.dev/p/who-rebooted-my-vm/cover.png'><meta name=twitter:title content="Who rebooted my VM? A cloud mystery"><meta name=twitter:description content="Investigating from a linux perspective, if the cloud provider is to be blamed for a virtual machine reboot."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://www.niederwanger.dev/p/who-rebooted-my-vm/cover.png'><link rel="shortcut icon" href=/favicon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-SFGE7X3TQ5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("consent","default",{analytics_storage:localStorage.getItem("silktideCookieChoice_analytics")==="true"?"granted":"denied",ad_storage:localStorage.getItem("silktideCookieChoice_marketing")==="true"?"granted":"denied",ad_user_data:localStorage.getItem("silktideCookieChoice_marketing")==="true"?"granted":"denied",ad_personalization:localStorage.getItem("silktideCookieChoice_marketing")==="true"?"granted":"denied",functionality_storage:localStorage.getItem("silktideCookieChoice_necessary")==="true"?"granted":"denied",security_storage:localStorage.getItem("silktideCookieChoice_necessary")==="true"?"granted":"denied"}),gtag("js",new Date),gtag("config","G-SFGE7X3TQ5",{anonymize_ip:!0})</script><link rel=stylesheet id=silktide-consent-manager-css href=/silktide-consent-manager.css><script src=/silktide-consent-manager.js></script><script>silktideCookieBannerManager.updateCookieBannerConfig({background:{showBackground:!1},cookieIcon:{position:"bottomRight"},cookieTypes:[{id:"necessary",name:"Necessary",description:"<p>These cookies are necessary for the website to function properly and cannot be switched off. They help with things like logging in and setting your privacy preferences.</p>",required:!0,onAccept:function(){console.log("Add logic for the required Necessary here")}},{id:"analytics",name:"Analytical",description:"<p>These cookies help us improve the site by tracking which pages are most popular and how visitors move around the site.</p>",defaultValue:!0,onAccept:function(){gtag("consent","update",{analytics_storage:"granted"}),dataLayer.push({event:"consent_accepted_analytics"})},onReject:function(){gtag("consent","update",{analytics_storage:"denied"})}},{id:"advertising",name:"Advertising",description:"<p>These cookies provide extra features and personalization to improve your experience. They may be set by us or by partners whose services we use.</p>",onAccept:function(){gtag("consent","update",{ad_storage:"granted",ad_user_data:"granted",ad_personalization:"granted"}),dataLayer.push({event:"consent_accepted_advertising"})},onReject:function(){gtag("consent","update",{ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied"})}}],text:{banner:{description:'<p>We use cookies on our site to enhance your user experience, provide personalized content, and analyze our traffic. <a href="/cookie-policy" target="_blank">Cookie Policy.</a></p>',acceptAllButtonText:"Accept all",acceptAllButtonAccessibleLabel:"Accept all cookies",rejectNonEssentialButtonText:"Reject non-essential",rejectNonEssentialButtonAccessibleLabel:"Reject non-essential",preferencesButtonText:"Preferences",preferencesButtonAccessibleLabel:"Toggle preferences"},preferences:{title:"Customize your cookie preferences",description:"<p>We respect your right to privacy. You can choose not to allow some types of cookies. Your cookie preferences will apply across our website.</p>",creditLinkText:"Get this banner for free",creditLinkAccessibleLabel:"Get this banner for free"}},position:{banner:"bottomCenter"}})</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_606e512111a631e0.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Kevin Niederwanger</a></h1><h2 class=site-description>Personal blog mostly focused on technical topics around Linux and Kubernetes.</h2></div></header><ol class=menu-social><li><a href=https://github.com/Skalador target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/kevin-niederwanger/ target=_blank title=LinkedIn rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-linkedin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 10-4 0"/><path d="M3 7a4 4 0 014-4h10a4 4 0 014 4v10a4 4 0 01-4 4H7a4 4 0 01-4-4z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/cookie-policy/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-cookie"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path stroke="none" d="M0 0h24v24H0z"/><path d="M8 13v.01"/><path d="M12 17v.01"/><path d="M12 12v.01"/><path d="M16 14v.01"/><path d="M11 8v.01"/><path d="M13.148 3.476l2.667 1.104a4 4 0 004.656 6.14l.053.132a3 3 0 010 2.296Q19.779 14.328 19.5 15q-.283.684-.66 2.216a3 3 0 01-1.624 1.623q-1.572.394-2.216.661-.712.295-1.852 1.024a3 3 0 01-2.296.0Q9.649 19.77 9 19.5q-.707-.292-2.216-.66a3 3 0 01-1.623-1.624Q4.764 15.639 4.5 15q-.298-.718-1.024-1.852a3 3 0 010-2.296Q4.195 9.736 4.5 9q.257-.62.66-2.216a3 3 0 011.624-1.623Q8.331 4.777 9 4.5q.687-.285 1.852-1.024a3 3 0 012.296.0"/></svg>
<span>Cookie Policy</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#who-rebooted-my-vm-a-cloud-mystery>Who rebooted my VM? A cloud mystery</a></li><li><a href=#case-1-user-reboot>Case 1: User reboot</a></li><li><a href=#case-2-machine-config-rollout>Case 2: Machine Config rollout</a></li><li><a href=#case-3-a-container-with-elevated-privileges-was-compromised>Case 3: A container with elevated privileges was compromised</a></li><li><a href=#case-4-the-hypervisor-triggered-a-soft-reboot>Case 4: The hypervisor triggered a soft reboot</a></li><li><a href=#case-5-the-hypervisor-triggered-a-hard-reset>Case 5: The hypervisor triggered a hard reset</a></li><li><a href=#case-6-a-kernel-panic-occured>Case 6: A kernel panic occured</a></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/who-rebooted-my-vm/><img src=/p/who-rebooted-my-vm/cover_hu_b1abd5cbf7b77c1d.png srcset="/p/who-rebooted-my-vm/cover_hu_b1abd5cbf7b77c1d.png 800w, /p/who-rebooted-my-vm/cover_hu_a2760c1c733dbb6b.png 1600w" width=800 height=286 loading=lazy alt="Featured image of post Who rebooted my VM? A cloud mystery"></a></div><div class=article-details><header class=article-category><a href=/categories/kubernetes/>Kubernetes
</a><a href=/categories/openshift/>Openshift
</a><a href=/categories/linux/>Linux</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/who-rebooted-my-vm/>Who rebooted my VM? A cloud mystery</a></h2><h3 class=article-subtitle>Investigating from a linux perspective, if the cloud provider is to be blamed for a virtual machine reboot.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 04, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>9 minute read</time></div></footer></div></header><section class=article-content><h2 id=who-rebooted-my-vm-a-cloud-mystery>Who rebooted my VM? A cloud mystery</h2><p>I had been recently involved in an interesting discussion on how to figure out, who has rebooted your virtual machine from a linux perspective. In this particular case, we were talking about an OpenShift <code>node</code>. I will be elaborating on a few different cases and how those can be investigated.</p><p>To reproduce the problem, I am using a five node OpenShift cluster which is running on a <code>Kernel Based Virtual Machine (KVM)</code> host.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ oc get nodes
</span></span><span class=line><span class=cl>NAME        STATUS   ROLES                         AGE     VERSION
</span></span><span class=line><span class=cl>compute-0   Ready    worker                        3d23h   v1.31.6
</span></span><span class=line><span class=cl>compute-1   Ready    worker                        3d23h   v1.31.6
</span></span><span class=line><span class=cl>master-0    Ready    control-plane,master,worker   3d23h   v1.31.6
</span></span><span class=line><span class=cl>master-1    Ready    control-plane,master,worker   3d23h   v1.31.6
</span></span><span class=line><span class=cl>master-2    Ready    control-plane,master,worker   3d23h   v1.31.6
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ virsh list
</span></span><span class=line><span class=cl> Id   Name             State
</span></span><span class=line><span class=cl>--------------------------------
</span></span><span class=line><span class=cl> <span class=m>2</span>    ocp4-master-0    running
</span></span><span class=line><span class=cl> <span class=m>3</span>    ocp4-master-1    running
</span></span><span class=line><span class=cl> <span class=m>4</span>    ocp4-master-2    running
</span></span><span class=line><span class=cl> <span class=m>5</span>    ocp4-compute-0   running
</span></span><span class=line><span class=cl> <span class=m>6</span>    ocp4-compute-1   running
</span></span></code></pre></td></tr></table></div></div><p>Consequently, I am my own hypervisor admin which will be sabotaging my OpenShift cluster for this investigation.</p><p>What all cases will have in common is that a node will be <code>NotReady</code> for some time, e.g.:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ oc get nodes   
</span></span><span class=line><span class=cl>NAME        STATUS     ROLES                         AGE     VERSION
</span></span><span class=line><span class=cl>compute-0   Ready      worker                        4d15h   v1.31.6
</span></span><span class=line><span class=cl>compute-1   NotReady   worker                        4d15h   v1.31.6
</span></span><span class=line><span class=cl>master-0    Ready      control-plane,master,worker   4d15h   v1.31.6
</span></span><span class=line><span class=cl>master-1    Ready      control-plane,master,worker   4d15h   v1.31.6
</span></span><span class=line><span class=cl>master-2    Ready      control-plane,master,worker   4d15h   v1.31.6
</span></span></code></pre></td></tr></table></div></div><p>Additionally you will be able to find logs of the machine config controller which reports a <code>NotReady</code> machine:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ oc -n openshift-machine-config-operator logs machine-config-controller-5f88fbbc4f-rqjm4 -c machine-config-controller <span class=p>|</span> grep -i compute-1
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>I0404 06:41:13.153952       <span class=m>1</span> node_controller.go:584<span class=o>]</span> Pool worker: node compute-1: Reporting unready: node compute-1 is reporting <span class=nv>OutOfDisk</span><span class=o>=</span>Unknown
</span></span><span class=line><span class=cl>I0404 06:41:13.196590       <span class=m>1</span> node_controller.go:584<span class=o>]</span> Pool worker: node compute-1: changed taints
</span></span><span class=line><span class=cl>I0404 06:41:19.481728       <span class=m>1</span> node_controller.go:584<span class=o>]</span> Pool worker: node compute-1: changed taints
</span></span><span class=line><span class=cl>I0404 06:42:42.730148       <span class=m>1</span> node_controller.go:584<span class=o>]</span> Pool worker: node compute-1: Reporting unready: node compute-1 is reporting <span class=nv>NotReady</span><span class=o>=</span>False
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>I0404 06:42:56.309260       <span class=m>1</span> node_controller.go:584<span class=o>]</span> Pool worker: node compute-1: Reporting ready
</span></span></code></pre></td></tr></table></div></div><h2 id=case-1-user-reboot>Case 1: User reboot</h2><p>In this case a user has rebooted one of your nodes (either via a <code>debug</code> container or via <code>ssh</code>). This can be easily found with the audit logs:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ cat /var/log/audit/audit.log <span class=p>|</span> grep reboot
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl><span class=nv>type</span><span class=o>=</span>USER_CMD <span class=nv>msg</span><span class=o>=</span>audit<span class=o>(</span>1743748835.979:805<span class=o>)</span>: <span class=nv>pid</span><span class=o>=</span><span class=m>1366614</span> <span class=nv>uid</span><span class=o>=</span><span class=m>0</span> <span class=nv>auid</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>ses</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>subj</span><span class=o>=</span>system_u:system_r:spc_t:s0 <span class=nv>msg</span><span class=o>=</span><span class=s1>&#39;cwd=&#34;/&#34; cmd=&#34;reboot&#34; exe=&#34;/usr/bin/sudo&#34; terminal=? res=success&#39;</span><span class=nv>UID</span><span class=o>=</span><span class=s2>&#34;root&#34;</span> <span class=nv>AUID</span><span class=o>=</span><span class=s2>&#34;unset&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=case-2-machine-config-rollout>Case 2: Machine Config rollout</h2><p>A machine config rollout can also be found in the <code>audit.log</code> files:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ cat /var/log/audit/audit.log <span class=p>|</span> grep reboot
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl><span class=nv>type</span><span class=o>=</span>SERVICE_START <span class=nv>msg</span><span class=o>=</span>audit<span class=o>(</span>1743789169.017:1277<span class=o>)</span>: <span class=nv>pid</span><span class=o>=</span><span class=m>1</span> <span class=nv>uid</span><span class=o>=</span><span class=m>0</span> <span class=nv>auid</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>ses</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>subj</span><span class=o>=</span>system_u:system_r:init_t:s0 <span class=nv>msg</span><span class=o>=</span><span class=s1>&#39;unit=machine-config-daemon-reboot comm=&#34;systemd&#34; exe=&#34;/usr/lib/systemd/systemd&#34; hostname=? addr=? terminal=? res=success&#39;</span>^<span class=o>]</span><span class=nv>UID</span><span class=o>=</span><span class=s2>&#34;root&#34;</span> <span class=nv>AUID</span><span class=o>=</span><span class=s2>&#34;unset&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>type</span><span class=o>=</span>SERVICE_STOP <span class=nv>msg</span><span class=o>=</span>audit<span class=o>(</span>1743789169.119:1278<span class=o>)</span>: <span class=nv>pid</span><span class=o>=</span><span class=m>1</span> <span class=nv>uid</span><span class=o>=</span><span class=m>0</span> <span class=nv>auid</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>ses</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>subj</span><span class=o>=</span>system_u:system_r:init_t:s0 <span class=nv>msg</span><span class=o>=</span><span class=s1>&#39;unit=machine-config-daemon-reboot comm=&#34;systemd&#34; exe=&#34;/usr/lib/systemd/systemd&#34; hostname=? addr=? terminal=? res=success&#39;</span>^<span class=o>]</span><span class=nv>UID</span><span class=o>=</span><span class=s2>&#34;root&#34;</span> <span class=nv>AUID</span><span class=o>=</span><span class=s2>&#34;unset
</span></span></span></code></pre></td></tr></table></div></div><p>Furthermore this can be confirmed with the <code>MachineConfigPool</code>, which provides us with the latest <code>MachineConfig</code> <code>rendered-worker-04636f9acf052beffabf57725a564095</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ oc get mcp worker       
</span></span><span class=line><span class=cl>NAME     CONFIG                                             UPDATED   UPDATING   DEGRADED   MACHINECOUNT   READYMACHINECOUNT   UPDATEDMACHINECOUNT   DEGRADEDMACHINECOUNT   AGE
</span></span><span class=line><span class=cl>worker   rendered-worker-04636f9acf052beffabf57725a564095   True      False      False      <span class=m>2</span>              <span class=m>2</span>                   <span class=m>2</span>                     <span class=m>0</span>                      5d2h
</span></span></code></pre></td></tr></table></div></div><p>Looking at the boot IDs, we should see, that boot id <code>57cdb3ac10fd46c3933a3f0ba3e3c33f</code> should be shutdown by the machine config operator with a message, that it will boot into <code>rendered-worker-04636f9acf052beffabf57725a564095</code>. This is the case:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ journalctl --list-boots <span class=p>|</span> tail -n <span class=m>2</span>
</span></span><span class=line><span class=cl> -1 57cdb3ac10fd46c3933a3f0ba3e3c33f Fri 2025-04-04 07:47:43 UTC Fri 2025-04-04 17:53:13 UTC
</span></span><span class=line><span class=cl>  <span class=m>0</span> 6004e8be8fbc4d769485a991ff1641d4 Fri 2025-04-04 17:53:19 UTC Fri 2025-04-04 18:04:01 UTC
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ journalctl -u machine-config-daemon-reboot
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>-- Boot 57cdb3ac10fd46c3933a3f0ba3e3c33f --
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:52:49 compute-1 systemd<span class=o>[</span>1<span class=o>]</span>: Started machine-config-daemon: Node will reboot into config rendered-worker-04636f9acf052beffabf57725a564095.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:52:49 compute-1 systemd<span class=o>[</span>1<span class=o>]</span>: machine-config-daemon-reboot.service: Deactivated successfully.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:52:49 compute-1 systemd<span class=o>[</span>1<span class=o>]</span>: Stopped machine-config-daemon: Node will reboot into config rendered-worker-04636f9acf052beffabf57725a564095.
</span></span></code></pre></td></tr></table></div></div><h2 id=case-3-a-container-with-elevated-privileges-was-compromised>Case 3: A container with elevated privileges was compromised</h2><p>Some containers require elevated privileges to perform certain actions on OpenShift. If such a container is compromised, then a reboot could be initiated from the container. In this example I will be using a container of the <code>Node Tuning Operator</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ oc -n openshift-cluster-node-tuning-operator get pods -owide                                          
</span></span><span class=line><span class=cl>NAME                                            READY   STATUS    RESTARTS   AGE     IP              NODE        NOMINATED NODE   READINESS GATES
</span></span><span class=line><span class=cl>cluster-node-tuning-operator-5bb647f57c-lk7wx   1/1     Running   <span class=m>0</span>          4d15h   X.X.X.X         master-1    &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>tuned-5q7vm                                     1/1     Running   <span class=m>1</span>          4d15h   X.X.X.X         compute-0   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>tuned-8n89v                                     1/1     Running   <span class=m>1</span>          4d15h   X.X.X.X         compute-1   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>tuned-g7nwk                                     1/1     Running   <span class=m>0</span>          4d15h   X.X.X.X         master-0    &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>tuned-rxt2q                                     1/1     Running   <span class=m>0</span>          4d15h   X.X.X.X         master-2    &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>tuned-xsm98                                     1/1     Running   <span class=m>0</span>          4d15h   X.X.X.X         master-1    &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>$ oc -n openshift-cluster-node-tuning-operator rsh tuned-8n89v
</span></span><span class=line><span class=cl>$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span><span class=line><span class=cl>$ date
</span></span><span class=line><span class=cl>Fri Apr  <span class=m>4</span> 07:25:01 UTC <span class=m>2025</span>
</span></span><span class=line><span class=cl>$ reboot           
</span></span></code></pre></td></tr></table></div></div><p>One interesting fact here is, that we do not see this reboot in the <code>audit.log</code>, as the last entry for a <code>reboot</code> is the same as the one from <code>Case 1</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ cat /var/log/audit/audit.log <span class=p>|</span> grep reboot <span class=p>|</span> tail -n <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nv>type</span><span class=o>=</span>USER_CMD <span class=nv>msg</span><span class=o>=</span>audit<span class=o>(</span>1743748835.979:805<span class=o>)</span>: <span class=nv>pid</span><span class=o>=</span><span class=m>1366614</span> <span class=nv>uid</span><span class=o>=</span><span class=m>0</span> <span class=nv>auid</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>ses</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>subj</span><span class=o>=</span>system_u:system_r:spc_t:s0 <span class=nv>msg</span><span class=o>=</span><span class=s1>&#39;cwd=&#34;/&#34; cmd=&#34;reboot&#34; exe=&#34;/usr/bin/sudo&#34; terminal=? res=success&#39;</span><span class=nv>UID</span><span class=o>=</span><span class=s2>&#34;root&#34;</span> <span class=nv>AUID</span><span class=o>=</span><span class=s2>&#34;unset&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Nevertheless, we can see in the <code>journalctl</code> that the <code>reboot</code> was initiated. Please also note, that the reboot was initiated shortly after <code>Fri Apr 4 07:25:01 UTC 2025</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ journalctl -b -1 <span class=p>|</span> grep -i reboot <span class=p>|</span> tail -n <span class=m>3</span>
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 07:25:06 compute-1 systemd-logind<span class=o>[</span>906<span class=o>]</span>: The system will reboot now!
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 07:25:06 compute-1 systemd-logind<span class=o>[</span>906<span class=o>]</span>: System is rebooting.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 07:26:41 compute-1 systemd<span class=o>[</span>1<span class=o>]</span>: Requested transaction contradicts existing jobs: Transaction <span class=k>for</span> NetworkManager-dispatcher.service/start is destructive <span class=o>(</span>reboot.target has <span class=s1>&#39;start&#39;</span> job queued, but <span class=s1>&#39;stop&#39;</span> is included in transaction<span class=o>)</span>.
</span></span></code></pre></td></tr></table></div></div><p>While an audit rule might be helping to detect that the <code>reboot</code> was started via <code>/usr/sbin/reboot</code> from a container, this is probably not something of practical relevance.</p><h2 id=case-4-the-hypervisor-triggered-a-soft-reboot>Case 4: The hypervisor triggered a soft reboot</h2><p>To differentiate better between those cases, we will be using <code>compute-0</code> for the reboots initiated by the hypervisor / cloud provider instead of <code>compute-1</code>.
For a (kind of) graceful shutdown we will be using the <code>virsh reboot</code> command. To provide a rough idea what this does, we can take a look at the man page for <code>virsh reboot</code>:</p><blockquote><p>Reboot a domain. This acts just as if the domain had the reboot command run from the console. The command returns as soon as it has executed the reboot action, which may be significantly before the domain actually reboots.</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ date
</span></span><span class=line><span class=cl>Fri Apr  <span class=m>4</span> 06:59:52 PM CEST <span class=m>2025</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ virsh reboot ocp4-compute-0
</span></span><span class=line><span class=cl>Domain <span class=s1>&#39;ocp4-compute-0&#39;</span> is being rebooted
</span></span></code></pre></td></tr></table></div></div><p>We can find a related <code>audit.log</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ ausearch -m SERVICE_STOP <span class=p>|</span> grep -Ei <span class=s1>&#39;shutdownd|shutdown|reboot|final|auditd&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>type</span><span class=o>=</span>SERVICE_STOP <span class=nv>msg</span><span class=o>=</span>audit<span class=o>(</span>1743785996.839:279<span class=o>)</span>: <span class=nv>pid</span><span class=o>=</span><span class=m>1</span> <span class=nv>uid</span><span class=o>=</span><span class=m>0</span> <span class=nv>auid</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>ses</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>subj</span><span class=o>=</span>system_u:system_r:init_t:s0 <span class=nv>msg</span><span class=o>=</span><span class=s1>&#39;unit=dracut-shutdown comm=&#34;systemd&#34; exe=&#34;/usr/lib/systemd/systemd&#34; hostname=? addr=? terminal=? res=success&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Additionally we see the shutdown process in the <code>journalctl</code> of the previous boot:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ journalctl -b -1 <span class=p>|</span> grep -i shutdown <span class=p>|</span> tail -n <span class=m>6</span>
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 16:59:56 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: Stopping Restore /run/initramfs on shutdown...
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 16:59:56 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: dracut-shutdown.service: Deactivated successfully.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 16:59:56 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: Stopped Restore /run/initramfs on shutdown.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:00:42 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: Requested transaction contradicts existing jobs: Transaction <span class=k>for</span> NetworkManager-dispatcher.service/start is destructive <span class=o>(</span>shutdown.target has <span class=s1>&#39;start&#39;</span> job queued, but <span class=s1>&#39;stop&#39;</span> is included in transaction<span class=o>)</span>.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:00:43 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: Stopping Record System Boot/Shutdown in UTMP...
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:00:43 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: Stopped Record System Boot/Shutdown in UTMP.
</span></span></code></pre></td></tr></table></div></div><p>Note: While the timezone configuration is different, those logs are related to the same <code>virsh reboot</code>.</p><h2 id=case-5-the-hypervisor-triggered-a-hard-reset>Case 5: The hypervisor triggered a hard reset</h2><p>For this experiment we will be using the <code>virsh reset</code> command. To provide a rough idea what this does, we can take a look at the man page for <code>virsh reset</code>:</p><blockquote><p>Reset a domain immediately without any guest shutdown. reset emulates the power reset button on a machine, where all guest hardware sees the RST line set and reinitializes internal state.
Note: Reset without any guest OS shutdown risks data loss.</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ date
</span></span><span class=line><span class=cl>Fri Apr  <span class=m>4</span> 07:17:45 PM CEST <span class=m>2025</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ virsh reset ocp4-compute-0
</span></span><span class=line><span class=cl>Domain <span class=s1>&#39;ocp4-compute-0&#39;</span> was reset
</span></span></code></pre></td></tr></table></div></div><p>The only <code>audit.log</code> we can find, is the one form before:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$  ausearch -m SERVICE_STOP <span class=p>|</span> grep -Ei <span class=s1>&#39;shutdownd|shutdown|reboot|final|auditd&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>type</span><span class=o>=</span>SERVICE_STOP <span class=nv>msg</span><span class=o>=</span>audit<span class=o>(</span>1743785996.839:279<span class=o>)</span>: <span class=nv>pid</span><span class=o>=</span><span class=m>1</span> <span class=nv>uid</span><span class=o>=</span><span class=m>0</span> <span class=nv>auid</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>ses</span><span class=o>=</span><span class=m>4294967295</span> <span class=nv>subj</span><span class=o>=</span>system_u:system_r:init_t:s0 <span class=nv>msg</span><span class=o>=</span><span class=s1>&#39;unit=dracut-shutdown comm=&#34;systemd&#34; exe=&#34;/usr/lib/systemd/systemd&#34; hostname=? addr=? terminal=? res=success&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>journalctl</code> of the previous boot also suddenly ends without a shutdown sequence:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ journalctl -b -1 <span class=p>|</span>  tail -n <span class=m>2</span>
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:16:11 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: Finished Cleanup of Temporary Directories.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:16:11 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: run-credentials-systemd<span class=se>\x</span>2dtmpfiles<span class=se>\x</span>2dclean.service.mount: Deactivated successfully.
</span></span></code></pre></td></tr></table></div></div><p>Note: The shutdown was initiated at <code>17:17:45</code> when considering the different timezone configurations.</p><p>Nevertheless, we can have an indicator, that the previous boot had an unclean shutdown by seeing if there was</p><ul><li>A recovery started during latest boot</li><li>A filesystem check initiated during latest boot.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ journalctl -b <span class=m>0</span> <span class=p>|</span>  grep -iE <span class=s1>&#39;recover|fsck&#39;</span>
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:17:58 localhost systemd-fsck<span class=o>[</span>651<span class=o>]</span>: /usr/sbin/fsck.xfs: XFS file system.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:17:58 localhost kernel: XFS <span class=o>(</span>vda4<span class=o>)</span>: Starting recovery <span class=o>(</span>logdev: internal<span class=o>)</span> &lt;<span class=o>=====</span> HERE
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:17:58 localhost kernel: XFS <span class=o>(</span>vda4<span class=o>)</span>: Ending recovery <span class=o>(</span>logdev: internal<span class=o>)</span> &lt;<span class=o>=====</span> HERE
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:17:59 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: Created slice Slice /system/systemd-fsck.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:17:59 compute-0 systemd<span class=o>[</span>1<span class=o>]</span>: systemd-fsck-root.service: Deactivated successfully.
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:18:00 compute-0 systemd-fsck<span class=o>[</span>819<span class=o>]</span>: boot: recovering journal &lt;<span class=o>=====</span> HERE
</span></span><span class=line><span class=cl>Apr <span class=m>04</span> 17:18:00 compute-0 systemd-fsck<span class=o>[</span>819<span class=o>]</span>: boot: clean, 365/98304 files, 150426/393216 blocks
</span></span></code></pre></td></tr></table></div></div><p>We see that the system did not go through a normal shutdown sequence due to the presence of <code>XFS</code> recovery and <code>fsck</code> journal recovery which confirms that filesystems were not cleanly unmounted. See the <code>unclean unmounts</code> section in the <a class=link href=https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_file_systems/checking-and-repairing-a-file-system__managing-file-systems#error-handling-mechanisms-in-xfs_checking-and-repairing-a-file-system target=_blank rel=noopener>RHEL 9 docs for XFS</a>.</p><h2 id=case-6-a-kernel-panic-occured>Case 6: A kernel panic occured</h2><p>A kernel panic is a safety measure taken by the kernel of an operating system when an internal fatal error is detected, such as hardware failures and memory corruption. First we need to clarify, if a system would reboot in such a case. The responsible setting is <code>kernel.panic</code>, where <code>0</code> means that the system is not rebooted. Any other value indicates the number of seconds which are waited before the reboot is triggered, see further <a class=link href=https://docs.kernel.org/admin-guide/sysctl/kernel.html#panic target=_blank rel=noopener>kernel docs</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ sysctl kernel.panic
</span></span><span class=line><span class=cl>kernel.panic <span class=o>=</span> <span class=m>10</span>
</span></span></code></pre></td></tr></table></div></div><p>If a kernel panic would have happened, we would usually find a corresponding file in <code>/sys/fs/pstore/</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ ls /sys/fs/pstore/
</span></span><span class=line><span class=cl>sh-5.1# 
</span></span></code></pre></td></tr></table></div></div><p>As the setup here is a bit more complicated for OpenShift, I will leave it without an example. For further readings, please follow the <a class=link href=https://docs.kernel.org/admin-guide/pstore-blk.html target=_blank rel=noopener>kernel docs</a>.</p><h2 id=conclusion>Conclusion</h2><p>Linux offers many powerful utilities to understand what has happened on your system. This includes user initiated actions, hypervisor / cloud provider activity and even hardware failures. If you have other indicators which you are usually verifying, please let me know.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/kubernetes/>Kubernetes</a>
<a href=/tags/openshift/>Openshift</a>
<a href=/tags/linux/>Linux</a>
<a href=/tags/cloud/>Cloud</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Apr 04, 2025 00:00 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/kubevirt-to-run-vms-on-k8s/><div class=article-image><img src=/p/kubevirt-to-run-vms-on-k8s/cover.f8f56d61acecb6a6bc170997cc98c805_hu_6452b2195ea6b840.png width=250 height=150 loading=lazy alt="Featured image of post KubeVirt with libvirt/QEMU/KVM in Kind" data-key=kubevirt-to-run-vms-on-k8s data-hash="md5-+PVtYazstqa8FwmXzJjIBQ=="></div><div class=article-details><h2 class=article-title>KubeVirt with libvirt/QEMU/KVM in Kind</h2></div></a></article><article class=has-image><a href=/p/gaming-on-linux-with-a-decade-old-hardware/><div class=article-image><img src=/p/gaming-on-linux-with-a-decade-old-hardware/gaming.e1b803b98e49cd523d818badf6c3c721_hu_b3a93190e4901308.jpg width=250 height=150 loading=lazy alt="Featured image of post Gaming on Linux with a decade old hardware" data-key=gaming-on-linux-with-a-decade-old-hardware data-hash="md5-4bgDuY5JzVI9gYut9sPHIQ=="></div><div class=article-details><h2 class=article-title>Gaming on Linux with a decade old hardware</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 Kevin Niederwanger</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>